import matplotlib
import numpy as np
from matplotlib import pyplot as plt


# No eps
# times: [48.893373012542725, 49.90970993041992, 50.3910129070282, 50.74644207954407, 50.52164602279663, 50.42991304397583, 50.94157290458679, 51.73954701423645, 51.55245113372803, 52.632718086242676, 53.21016502380371, 54.085521936416626, 54.57320809364319, 54.617215156555176, 54.987509965896606, 55.439756870269775, 56.02452898025513, 53.0288188457489, 53.517695903778076, 52.98933386802673, 52.899139165878296, 53.534428119659424, 55.57452392578125, 56.571183919906616, 57.13955092430115, 55.27966094017029, 55.45153999328613, 55.09257388114929, 55.510470151901245, 56.80233097076416, 57.572551012039185, 56.88205599784851, 56.55246686935425, 54.77645301818848, 59.55672812461853, 55.173027992248535, 60.74354600906372, 56.129393100738525, 56.89080190658569, 56.78243088722229, 56.86236500740051, 52.33983612060547, 57.81936311721802, 59.02333211898804, 54.944713830947876, 57.63721680641174, 55.54130506515503, 56.488415002822876, 59.235984086990356, 55.80729293823242]
# results: [-4.592114170507443, -50.47417657767113, -26.834208612163252, 0.6429290282159172, -18.20133859787626, -22.72221956184319, -22.9706142652567, -49.95855636813559, -13.873943377152614, -22.59564212736126, -8.352806553887035, -50.474316954728636, -50.28441412788163, -22.97354084349041, -22.215567666426864, -50.47445910416138, -16.388042416616486, -22.709661447057385, -15.298879651171092, -50.47400400884476, -50.46522635437873, -50.47447606709267, -19.632688606512488, -49.975907328929736, -50.19939880850018, -13.204622115524558, -50.4007848530199, -50.47355499363886, -50.35739163751691, -50.47447606709267, -50.17843863533619, -6.618472208201297, -3.484980450136675, -16.958156988093947, -50.47447606709267, -22.77113459061826, -50.47446896058295, -50.46871852046661, -7.502362682724765, -50.46169458315046, -3.9786342271752346, -17.260126510474436, -8.3336535615054, -20.334561133615694, -8.878828352210007, 0.7724322504777206, -50.47446917642583, -49.73776880214109, -50.47443675733871, -21.370907291336778]
# true results: [-4.5636136465050896, -50.57559802249208, -26.945065122076372, 0.54340945219682624, -18.60862730561503, -23.21288774379714, -23.470185404782356, -50.095420419237726, -13.838862801848961, -23.08404974335501, -8.6215267506235023, -50.575694162441124, -50.418741839454327, -23.47399745941793, -22.6922767230772, -50.575788343922845, -16.70784848218733, -22.776536043373042, -15.285467355270832, -50.57548667919454, -50.568415732801647, -50.575798342771982, -20.045190062031125, -50.120159460499934, -50.34762136705195, -13.185629567456871, -50.516281424093677, -50.575157625099877, -50.478071471444288, -50.575798342771982, -50.326593309576104, -6.6201454854546853, -3.7454281396637299, -17.063582190089804, -50.575798342771982, -23.262169709556176, -50.575794003863052, -50.571376324718443, -7.7946524493507781, -50.565451357606179, -4.1873787457198972, -17.297926837306676, -8.5752745171276672, -20.757435351835312, -8.9026093090825782, 0.64572862056796509, -50.575794009286192, -49.859613602843297, -50.575774458463357, -21.827853905639628]

# With eps
# times: [49.812609910964966, 53.40840697288513, 51.37424898147583, 52.099956035614014, 51.499967098236084, 51.004525899887085, 51.32815098762512, 50.53611087799072, 51.42238903045654, 53.73071599006653, 56.53889608383179, 54.876928091049194, 54.07648015022278, 51.12898015975952, 54.21868014335632, 48.63657903671265, 48.83331608772278, 47.49318194389343, 46.813035011291504, 47.477710008621216, 47.385273933410645, 47.7399218082428, 49.41708517074585, 48.30866503715515, 48.6831111907959, 48.18867611885071, 48.50034999847412, 48.86923694610596, 49.1510591506958, 49.369961977005005, 49.577873945236206, 49.29030895233154, 49.446855783462524, 48.10705804824829, 49.263229846954346, 50.30934405326843, 49.08416986465454, 49.9843270778656, 50.13303804397583, 49.88459897041321, 48.13244318962097, 46.960339069366455, 47.520447969436646, 47.739073038101196, 47.9489529132843, 48.1378390789032, 49.28453493118286, 48.64080309867859, 48.99997401237488, 48.81977605819702]
# results: [-5.592114170507443, -51.47417657767113, -27.834208612163252, -0.35707097180034, -19.20133859787626, -23.72221956184319, -23.9706142652567, -50.95855636813559, -14.873943377152614, -23.59564212736126, -9.352806553887035, -51.474316954728636, -51.28441412788163, -23.97354084349064, -23.215567666426864, -51.47445910416138, -17.388042416616486, -23.709661447057385, -16.29887965117109, -51.47400400884476, -51.46522635437873, -51.47447606709267, -20.632688606512488, -50.975907328929736, -51.19939880850018, -14.204622115524558, -51.4007848530199, -51.47355499363886, -51.35739163751691, -51.47447606709267, -51.17843863533619, -7.618472208201297, -4.484980450136675, -17.958156988093947, -51.47447606709267, -23.771134590618033, -51.47446896058295, -51.46871852046661, -8.502362682724765, -51.46169458315046, -4.978634227175235, -18.260126510474436, -9.3336535615054, -21.334561133615694, -9.878828352210007, -0.22756774953080594, -51.47446917642583, -50.73776880214109, -51.47443675733871, -22.370907291336778]
# true results: [-4.5636136465050896, -50.57559802249208, -26.945065122076372, 0.54340945219682624, -18.60862730561503, -23.21288774379714, -23.470185404782356, -50.095420419237726, -13.838862801848961, -23.08404974335501, -8.6215267506235023, -50.575694162441124, -50.418741839454327, -23.47399745941793, -22.6922767230772, -50.575788343922845, -16.70784848218733, -22.776536043373042, -15.285467355270832, -50.57548667919454, -50.568415732801647, -50.575798342771982, -20.045190062031125, -50.120159460499934, -50.34762136705195, -13.185629567456871, -50.516281424093677, -50.575157625099877, -50.478071471444288, -50.575798342771982, -50.326593309576104, -6.6201454854546853, -3.7454281396637299, -17.063582190089804, -50.575798342771982, -23.262169709556176, -50.575794003863052, -50.571376324718443, -7.7946524493507781, -50.565451357606179, -4.1873787457198972, -17.297926837306676, -8.5752745171276672, -20.757435351835312, -8.9026093090825782, 0.64572862056796509, -50.575794009286192, -49.859613602843297, -50.575774458463357, -21.827853905639628]

# with eps + eta
# times: [22.303488969802856, 21.75107502937317, 21.578250885009766, 21.933032989501953, 21.767959117889404, 21.970322847366333, 21.87534999847412, 21.769279956817627, 22.071599006652832, 20.590986013412476, 22.148237943649292, 21.618535041809082, 21.717843055725098, 21.31709313392639, 19.603655099868774, 19.003639936447144, 20.368717908859253, 20.208030939102173, 19.312561988830566, 19.610423803329468, 19.379378080368042, 19.128843069076538, 20.859462022781372, 21.36511993408203, 22.196894884109497, 21.42796802520752, 20.975409984588623, 22.11768388748169, 21.333508014678955, 21.434444904327393, 20.760058879852295, 22.6111798286438, 20.560343027114868, 21.66996479034424, 22.397778034210205, 22.17163896560669, 18.978275060653687, 18.815494060516357, 18.534796953201294, 20.789180040359497, 21.02116298675537, 22.1731059551239, 21.198801040649414, 21.574565887451172, 22.187208890914917, 21.696722984313965, 20.610244035720825, 21.201783895492554, 21.49332904815674, 21.50162386894226]
# results: [-7.699702707508266, -53.25310611140185, -30.04518882991721, -1.6423773013750043, -20.456310777136196, -24.977191740490184, -25.225586444016926, -52.83809350091042, -16.582548023429922, -24.850614305781505, -10.607778733183295, -53.25318541262084, -53.12301310503551, -25.2285130222391, -24.470539844974496, -53.25326355883277, -18.643014595825207, -25.792437826164416, -18.049486583990415, -53.25300787764394, -53.247389179105824, -53.25327257051441, -21.88766078559604, -52.855444461704394, -53.06281734108234, -16.0391112245714, -53.20500090817063, -53.25274109575099, -53.1735069136102, -53.25327257051441, -53.046051857504835, -9.84999432738715, -5.739952628465517, -20.387171420850905, -53.25327257051441, -25.02610676918846, -53.2532688426374, -53.249730011214126, -9.757334855704016, -53.244941369016146, -6.233606406657714, -20.354246156156876, -10.588625740892326, -22.58953331261, -12.069790207998778, -1.4825399280313718, -53.25326896099983, -52.61730593491558, -53.25325160099726, -23.625879470463474]
# true results: [-4.6086136448537189, -50.620598067922629, -26.990065118511119, 0.49840952937668703, -18.653627273541048, -23.257887741778063, -23.515185481516596, -50.140420425053037, -13.883862336357993, -23.129049834840828, -8.6665267217267257, -50.62069414932985, -50.46374185500126, -23.51899753814061, -22.737276718024958, -50.620788338623463, -16.752848468997257, -22.821536027982539, -15.330467548057385, -50.620486674930895, -50.613415725879378, -50.620798337227086, -20.090190134163208, -50.165159469082404, -50.392621378345041, -13.230629516861939, -50.561281413748262, -50.620157663711673, -50.523071486089876, -50.620798337227086, -50.371593294917311, -6.6651454838494715, -3.7904281050990392, -17.108582238640821, -50.620798337227086, -23.307169728498621, -50.620793996503195, -50.616376347667902, -7.8396524459730301, -50.610451351263578, -4.2323788720112105, -17.342926835064603, -8.6202745083142105, -20.802435566849056, -8.9476094635771162, 0.60072827580484045, -50.620794003766505, -49.904613600249171, -50.620774457414448, -21.872853786549143]

# with eps + eta + nu
# times: [19.068711042404175, 18.728933095932007, 18.70611310005188, 18.771090030670166, 18.73092007637024, 18.713655948638916, 18.854153871536255, 18.949750185012817, 18.64982795715332, 18.713873863220215, 18.711990118026733, 18.699228048324585, 18.80805492401123, 18.708391189575195, 18.87887215614319, 18.62189507484436, 18.809062957763672, 18.585581064224243, 18.65078592300415, 18.637041091918945, 18.72380805015564, 18.70457410812378, 19.42642903327942, 19.292649030685425, 19.152606964111328, 19.44637703895569, 19.455639839172363, 19.957336902618408, 18.625910997390747, 20.29523801803589, 19.932899951934814, 19.480375051498413, 20.364187955856323, 20.74698495864868, 20.49472188949585, 20.56100583076477, 24.73760485649109, 19.267997980117798, 18.37471604347229, 19.044312000274658, 20.24250602722168, 19.356312036514282, 19.838057041168213, 18.45733094215393, 20.375230073928833, 19.049057960510254, 19.60147190093994, 18.58265519142151, 19.134018898010254, 19.052253007888794]
# results: [-9.669170474214923, -54.79082884140183, -32.01617023793807, -2.7335193684767773, -21.1943986921367, -25.715279655490008, -25.96367435901709, -54.37581623091046, -18.048791624075932, -25.588702220780988, -11.345866648183232, -54.79090814262082, -54.66073583503555, -25.96660093723915, -25.20862775997466, -54.790986288832755, -19.381102510825258, -27.704399136164454, -19.54936536934042, -54.79073060764398, -54.785111909105865, -54.79099530051434, -22.62574870059541, -54.39316719170432, -54.60054007108238, -17.670905382919216, -54.74272363817062, -54.790463825750976, -54.71122964361024, -54.79099530051434, -54.58377458750476, -11.91247172738747, -6.478040543465454, -22.44964882085071, -54.79099530051434, -25.76419468418942, -54.79099157263738, -54.78745274121428, -10.495422770703954, -54.78266409901613, -6.971694321657765, -22.26620746615714, -11.326713655892263, -23.327621227656778, -14.041363643221189, -2.4241213343145205, -54.79099169099976, -54.15502866491562, -54.790974330997244, -24.363967385463525]
# true results: [-4.6086136448537189, -50.620598067922629, -26.990065118511119, 0.49840952937668703, -18.653627273541048, -23.257887741778063, -23.515185481516596, -50.140420425053037, -13.883862336357993, -23.129049834840828, -8.6665267217267257, -50.62069414932985, -50.46374185500126, -23.51899753814061, -22.737276718024958, -50.620788338623463, -16.752848468997257, -22.821536027982539, -15.330467548057385, -50.620486674930895, -50.613415725879378, -50.620798337227086, -20.090190134163208, -50.165159469082404, -50.392621378345041, -13.230629516861939, -50.561281413748262, -50.620157663711673, -50.523071486089876, -50.620798337227086, -50.371593294917311, -6.6651454838494715, -3.7904281050990392, -17.108582238640821, -50.620798337227086, -23.307169728498621, -50.620793996503195, -50.616376347667902, -7.8396524459730301, -50.610451351263578, -4.2323788720112105, -17.342926835064603, -8.6202745083142105, -20.802435566849056, -8.9476094635771162, 0.60072827580484045, -50.620794003766505, -49.904613600249171, -50.620774457414448, -21.872853786549143]

print "Generating cs results"
times = [19.068711042404175, 18.728933095932007, 18.70611310005188, 18.771090030670166, 18.73092007637024, 18.713655948638916, 18.854153871536255, 18.949750185012817, 18.64982795715332, 18.713873863220215, 18.711990118026733, 18.699228048324585, 18.80805492401123, 18.708391189575195, 18.87887215614319, 18.62189507484436, 18.809062957763672, 18.585581064224243, 18.65078592300415, 18.637041091918945, 18.72380805015564, 18.70457410812378, 19.42642903327942, 19.292649030685425, 19.152606964111328, 19.44637703895569, 19.455639839172363, 19.957336902618408, 18.625910997390747, 20.29523801803589, 19.932899951934814, 19.480375051498413, 20.364187955856323, 20.74698495864868, 20.49472188949585, 20.56100583076477, 24.73760485649109, 19.267997980117798, 18.37471604347229, 19.044312000274658, 20.24250602722168, 19.356312036514282, 19.838057041168213, 18.45733094215393, 20.375230073928833, 19.049057960510254, 19.60147190093994, 18.58265519142151, 19.134018898010254, 19.052253007888794]
noepsres = [-4.592114170507443, -50.47417657767113, -26.834208612163252, 0.6429290282159172, -18.20133859787626, -22.72221956184319, -22.9706142652567, -49.95855636813559, -13.873943377152614, -22.59564212736126, -8.352806553887035, -50.474316954728636, -50.28441412788163, -22.97354084349041, -22.215567666426864, -50.47445910416138, -16.388042416616486, -22.709661447057385, -15.298879651171092, -50.47400400884476, -50.46522635437873, -50.47447606709267, -19.632688606512488, -49.975907328929736, -50.19939880850018, -13.204622115524558, -50.4007848530199, -50.47355499363886, -50.35739163751691, -50.47447606709267, -50.17843863533619, -6.618472208201297, -3.484980450136675, -16.958156988093947, -50.47447606709267, -22.77113459061826, -50.47446896058295, -50.46871852046661, -7.502362682724765, -50.46169458315046, -3.9786342271752346, -17.260126510474436, -8.3336535615054, -20.334561133615694, -8.878828352210007, 0.7724322504777206, -50.47446917642583, -49.73776880214109, -50.47443675733871, -21.370907291336778]
noepsres = np.array(noepsres)
epsres = [-4.830114168268892, -50.71217657548044, -27.072208609917027, 0.40492902519292784, -18.439338602136104, -22.96021956548998, -23.208614269016948, -50.196556365910055, -14.111943375014846, -22.833642130781755, -8.590806558183317, -50.71231695253783, -50.52241412569077, -23.211540847239007, -22.453567669974518, -50.71245910197052, -16.62604242082523, -22.947661444808944, -15.536879648985632, -50.7120040066539, -50.7032263521981, -50.712476064902035, -19.87068861059629, -50.21390732670437, -50.43739880631915, -13.442622113343589, -50.63878485082898, -50.71155499144817, -50.59539163532605, -50.712476064902035, -50.41643863315528, -6.8564722059551855, -3.7229804539233555, -17.196156985850564, -50.712476064902035, -23.009134594188367, -50.71246895839221, -50.70671851828598, -7.740362683061335, -50.69969458096972, -4.216634231657736, -17.498126508225994, -8.571653565892234, -20.572561137656862, -9.116828349971286, 0.5344322469723579, -50.71246917423508, -49.975768799915556, -50.71243675514785, -21.608907295463496]
epsres = np.array(epsres)
epsetares = [-7.699702707508266, -53.25310611140185, -30.04518882991721, -1.6423773013750043, -20.456310777136196, -24.977191740490184, -25.225586444016926, -52.83809350091042, -16.582548023429922, -24.850614305781505, -10.607778733183295, -53.25318541262084, -53.12301310503551, -25.2285130222391, -24.470539844974496, -53.25326355883277, -18.643014595825207, -25.792437826164416, -18.049486583990415, -53.25300787764394, -53.247389179105824, -53.25327257051441, -21.88766078559604, -52.855444461704394, -53.06281734108234, -16.0391112245714, -53.20500090817063, -53.25274109575099, -53.1735069136102, -53.25327257051441, -53.046051857504835, -9.84999432738715, -5.739952628465517, -20.387171420850905, -53.25327257051441, -25.02610676918846, -53.2532688426374, -53.249730011214126, -9.757334855704016, -53.244941369016146, -6.233606406657714, -20.354246156156876, -10.588625740892326, -22.58953331261, -12.069790207998778, -1.4825399280313718, -53.25326896099983, -52.61730593491558, -53.25325160099726, -23.625879470463474]
epsetares = np.array(epsetares)
epsetanures = [-9.669170474214923, -54.79082884140183, -32.01617023793807, -2.7335193684767773, -21.1943986921367, -25.715279655490008, -25.96367435901709, -54.37581623091046, -18.048791624075932, -25.588702220780988, -11.345866648183232, -54.79090814262082, -54.66073583503555, -25.96660093723915, -25.20862775997466, -54.790986288832755, -19.381102510825258, -27.704399136164454, -19.54936536934042, -54.79073060764398, -54.785111909105865, -54.79099530051434, -22.62574870059541, -54.39316719170432, -54.60054007108238, -17.670905382919216, -54.74272363817062, -54.790463825750976, -54.71122964361024, -54.79099530051434, -54.58377458750476, -11.91247172738747, -6.478040543465454, -22.44964882085071, -54.79099530051434, -25.76419468418942, -54.79099157263738, -54.78745274121428, -10.495422770703954, -54.78266409901613, -6.971694321657765, -22.26620746615714, -11.326713655892263, -23.327621227656778, -14.041363643221189, -2.4241213343145205, -54.79099169099976, -54.15502866491562, -54.790974330997244, -24.363967385463525]
epsetanures = np.array(epsetanures)
trures = [-4.5636136465050896, -50.57559802249208, -26.945065122076372, 0.54340945219682624, -18.60862730561503, -23.21288774379714, -23.470185404782356, -50.095420419237726, -13.838862801848961, -23.08404974335501, -8.6215267506235023, -50.575694162441124, -50.418741839454327, -23.47399745941793, -22.6922767230772, -50.575788343922845, -16.70784848218733, -22.776536043373042, -15.285467355270832, -50.57548667919454, -50.568415732801647, -50.575798342771982, -20.045190062031125, -50.120159460499934, -50.34762136705195, -13.185629567456871, -50.516281424093677, -50.575157625099877, -50.478071471444288, -50.575798342771982, -50.326593309576104, -6.6201454854546853, -3.7454281396637299, -17.063582190089804, -50.575798342771982, -23.262169709556176, -50.575794003863052, -50.571376324718443, -7.7946524493507781, -50.565451357606179, -4.1873787457198972, -17.297926837306676, -8.5752745171276672, -20.757435351835312, -8.9026093090825782, 0.64572862056796509, -50.575794009286192, -49.859613602843297, -50.575774458463357, -21.827853905639628]
trures = np.array(trures)

print "Run times with eps"
print "Mean: {}".format(np.mean(times))
print "Std: {}".format(np.std(times))

ind = np.arange(len(epsres))
width = 0.20
matplotlib.rcParams.update({'font.size': 8})
matplotlib.rcParams.update({'figure.autolayout': True})
fig, ax = plt.subplots()
fig.set_size_inches(5,3)
ax.set_ylabel('Robustness Difference')
ax.set_xlabel('Sample')
bar4 = ax.bar(ind + 0*width, trures - epsetanures, 3*width, color='black')
bar3 = ax.bar(ind + 0*width, trures - epsetares, 3*width, color='b')
bar2 = ax.bar(ind + 0*width, trures - epsres, 3*width, color='g')
bar1 = ax.bar(ind, trures - noepsres, 3*width, color='r')
switchedmask = (trures - noepsres) * (trures - epsres) > 0
bar1b = ax.bar(ind[switchedmask], (trures - noepsres)[switchedmask], 3*width, color='r')
bar2b = ax.bar(ind[switchedmask], (trures - epsres)[switchedmask], 3*width, color='g')
plt.legend((bar1, bar2, bar3, bar4), ('$r(\phi^{0,0,0})$', '$r(\phi^{\delta,0,0})$',  '$r(\phi^{\delta,\eta,0})$',  '$r(\phi^{\delta,\eta,\\nu})$'),
           fancybox=True, framealpha=0.5, loc='upper center', ncol=4, columnspacing=1)
# plt.show()
fig.savefig('cs_ran_init_results.png')


